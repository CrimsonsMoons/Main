--- Load Kavo UI Library
local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/xHeptc/Kavo-UI-Library/main/source.lua"))()
local Window = Library.CreateLib("All Mobs Teleport", "DarkTheme")

local TeleportTab = Window:NewTab("Teleport")
local TeleportSection = TeleportTab:NewSection("Mob Teleport")

-- Player reference
local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local hrp = character:WaitForChild("HumanoidRootPart")

player.CharacterAdded:Connect(function(newChar)
    character = newChar
    hrp = character:WaitForChild("HumanoidRootPart")
end)

-- Function to get all BaseParts in workspace.Mobs
local function getMobParts()
    local parts = {}
    local mobsFolder = workspace:FindFirstChild("Mobs")
    if mobsFolder then
        for _, mob in pairs(mobsFolder:GetChildren()) do
            -- Grab the PrimaryPart if exists, else any BasePart inside the mob
            if mob.PrimaryPart then
                table.insert(parts, mob.PrimaryPart)
            else
                local basePart = mob:FindFirstChildWhichIsA("BasePart")
                if basePart then
                    table.insert(parts, basePart)
                end
            end
        end
    end
    return parts
end

-- === Universal toggle ===
local teleporting = false
TeleportSection:NewToggle("Auto Teleport Behind All Mobs", "Teleports behind every mob in workspace.Mobs", function(state)
    teleporting = state
    if teleporting then
        task.spawn(function()
            while teleporting do
                if hrp then
                    local targets = getMobParts()
                    for _, part in ipairs(targets) do
                        if part and part:IsDescendantOf(workspace) then
                            hrp.CFrame = part.CFrame * CFrame.new(0, 0, 5) -- behind mob
                            task.wait(0.2) -- small delay between mobs
                        end
                    end
                end
                task.wait(0.5) -- refresh rate for respawns
            end
        end)
    end
end)
