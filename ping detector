-- UNIVERSAL CLIENT-SIDE PING LABELS
-- Works in ANY Roblox game

local Players = game:GetService("Players")
local Stats = game:GetService("Stats")
local RunService = game:GetService("RunService")

local localPlayer = Players.LocalPlayer
local labels = {}

-- ðŸŽ¨ Color based on ping
local function getColor(ms)
	if ms < 80 then
		return Color3.fromRGB(0,255,0)
	elseif ms < 150 then
		return Color3.fromRGB(255,170,0)
	else
		return Color3.fromRGB(255,0,0)
	end
end

-- ðŸ·ï¸ Create label
local function attachLabel(player)
	player.CharacterAdded:Connect(function(char)
		local head = char:WaitForChild("Head", 5)
		if not head then return end

		-- Remove old
		if head:FindFirstChild("PingGui") then
			head.PingGui:Destroy()
		end

		local gui = Instance.new("BillboardGui")
		gui.Name = "PingGui"
		gui.Adornee = head
		gui.Size = UDim2.new(0, 100, 0, 25)
		gui.StudsOffset = Vector3.new(0, 2.5, 0)
		gui.AlwaysOnTop = true
		gui.Parent = head

		local text = Instance.new("TextLabel")
		text.Size = UDim2.fromScale(1,1)
		text.BackgroundTransparency = 1
		text.TextScaled = true
		text.Font = Enum.Font.GothamBold
		text.TextStrokeTransparency = 0.3
		text.Parent = gui

		labels[player] = text
	end)
end

-- Attach to players
for _, p in ipairs(Players:GetPlayers()) do
	attachLabel(p)
end

Players.PlayerAdded:Connect(attachLabel)

-- ðŸ”„ Update ping constantly
RunService.RenderStepped:Connect(function()
	local pingStat = Stats.Network.ServerStatsItem["Data Ping"]
	if not pingStat then return end

	local ping = math.floor(tonumber(pingStat:GetValueString():match("%d+")) or 0)

	for _, label in pairs(labels) do
		label.Text = ping .. " ms"
		label.TextColor3 = getColor(ping)
	end
end)
